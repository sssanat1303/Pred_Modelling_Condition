library(ggplot2)
library(tidyverse)
library(readxl)
library(lubridate)
library(corrplot)
library(naniar)
WWT_prior <- read_xlsx("C:/Users/SSabharwal/OneDrive - Watercare Services Limited/Pred_Modelling_Condition/WWT_prior/WWT_prioritisation_final.xlsx")
WWT_prior <- WWT_prior %>% select(-GIS_ID)
WWT_prior <- read_xlsx("C:/Users/SSabharwal/OneDrive - Watercare Services Limited/Pred_Modelling_Condition/WWT_prior/WWT_prioritisation_final.xlsx")
library(ggplot2)
library(tidyverse)
library(readxl)
library(lubridate)
library(corrplot)
library(naniar)
WWT_prior <- read_xlsx("C:/Users/SSabharwal/OneDrive - Watercare Services Limited/Pred_Modelling_Condition/WWT_prior/WWT_prioritisation_final.xlsx")
# Getting rid of useless columns
WWT_prior <- WWT_prior %>% select(-GIS_ID)
WWT_prior <- WWT_prior %>% select(-OBJECTID)
WWT_prior <- WWT_prior %>% select(-WSL_OBJECTID)
WWT_prior <- WWT_prior %>% select(-EQUIP_ID)
WWT_prior <- WWT_prior %>% select(-COMPKEY)
WWT_prior <- WWT_prior %>% select(-FAC_CODE)
WWT_prior <- WWT_prior %>% select(-FAC_DESC)
WWT_prior <- WWT_prior %>% select(-PROCESS)
WWT_prior <- WWT_prior %>% select(-GRP)
WWT_prior <- WWT_prior %>% select(-POSITION)
WWT_prior <- WWT_prior %>% select(-STATUS)
WWT_prior <- WWT_prior %>% select(-LINING)
WWT_prior <- WWT_prior %>% select(-US_INV)
WWT_prior <- WWT_prior %>% select(-DS_INV)
WWT_prior <- WWT_prior %>% select(-ACCURACY)
WWT_prior <- WWT_prior %>% select(-TYPE)
WWT_prior <- WWT_prior %>% select(-SERVICE)
WWT_prior <- WWT_prior %>% select(-DATASOURCE)
WWT_prior <- WWT_prior %>% select(-SUBTYPE)
WWT_prior <- WWT_prior %>% select(-FLOWDIR)
WWT_prior <- WWT_prior %>% select(-FLOWDIRACC)
WWT_prior <- WWT_prior %>% select(-HACOMPKEY)
WWT_prior <- WWT_prior %>% select(-R_STAT)
WWT_prior <- WWT_prior %>% select(-R_MAT)
WWT_prior <- WWT_prior %>% select(-R_DIA)
WWT_prior <- WWT_prior %>% select(-R_INST)
WWT_prior <- WWT_prior %>% select(-AQ_TYPE)
WWT_prior <- WWT_prior %>% select(-USE_AREA)
WWT_prior <- WWT_prior %>% select(-HAUNITTYPE)
WWT_prior <- WWT_prior %>% select(-USE_AREAID)
WWT_prior <- WWT_prior %>% select(-R_OWN)
WWT_prior <- WWT_prior %>% select(-OWN)
WWT_prior <- WWT_prior %>% select(-PARLINENO)
WWT_prior <- WWT_prior %>% select(-F_IwiAOI)
WWT_prior <- WWT_prior %>% select(-`New action`)
# Need to fix data types for certain columns/Need to fix and normalise some entries
WWT_prior <- WWT_prior %>%
mutate(across(where(is.character), as.factor))
WWT_prior$condition_CCTV_score <- as.numeric(WWT_prior$condition_CCTV_score)
WWT_prior$condition_overall_score_label <- as.factor(WWT_prior$condition_overall_score_label)
levels(WWT_prior$condition_CCTV_source) <- c(levels(WWT_prior$condition_CCTV_source), "None")
WWT_prior$condition_CCTV_source[is.na(WWT_prior$condition_CCTV_source)] <- "None"
WWT_prior$condition_CCTV_date <- as.factor(WWT_prior$condition_CCTV_date)
levels(WWT_prior$condition_CCTV_date) <- c(levels(WWT_prior$condition_CCTV_date), "None")
WWT_prior$condition_CCTV_date[is.na(WWT_prior$condition_CCTV_date)] <- "None"
WWT_prior$condition_CCTV_score <- as.factor(WWT_prior$condition_CCTV_score)
levels(WWT_prior$condition_CCTV_score) <- c(levels(WWT_prior$condition_CCTV_score), "None")
WWT_prior$condition_CCTV_score[is.na(WWT_prior$condition_CCTV_score)] <- "None"
WWT_prior$INSTALLED <- format(WWT_prior$INSTALLED, "%Y")
WWT_prior$INSTALLED <- as.numeric(WWT_prior$INSTALLED)
# Creating modelling data set and analysis data set
WWT.analysis <- WWT_prior
WWT.analysis <- WWT.analysis %>% select(-SHAPE_Length)
WWT.modelling <- WWT_prior
WWT.modelling <- WWT.modelling %>% select(-condition_overall_score)
WWT.modelling <- WWT.modelling %>% select(-criticality_overall_score)
WWT.modelling <- WWT.modelling %>% select(-criticality_overall_score_label)
WWT.modelling <- WWT.modelling %>% select(-criticality_operational_score)
WWT.modelling <- WWT.modelling %>% select(-criticality_pipe_type_score)
WWT.modelling <- WWT.modelling %>% select(-criticality_people_impacts_score)
WWT.modelling <- WWT.modelling %>% select(-criticality_people_impacts_dataset_s_)
WWT.modelling <- WWT.modelling %>% select(-criticality_environmental_impacts_score)
WWT.modelling <- WWT.modelling %>% select(-criticality_environmental_impacts_dataset_s_)
WWT.modelling <- WWT.modelling %>% select(-criticality_infiltration_score)
WWT.modelling <- WWT.modelling %>% select(-criticality_impact_of_failure_score)
WWT.modelling <- WWT.modelling %>% select(-criticality_flow_ratio)
WWT.modelling <- WWT.modelling %>% select(-criticality_confidence_scenario)
WWT.modelling <- WWT.modelling %>% select(-condition_confidence_scenario)
WWT.modelling <- WWT.modelling %>% select(-`Risk-score`)
knitr::opts_chunk$set(message = FALSE)
library(ggplot2)
library(tidyverse)
library(readxl)
library(lubridate)
library(corrplot)
library(naniar)
library(keras)
library(glmnet)
library(xgboost)
library(finalfit)
library(rpart)
library(MASS)
library(ranger)
myfit <- function(train_df, test_df, a = 0){
train_X <- as.matrix(train_df %>% dplyr::select(-Y))
train_y <- train_df$Y
test_X <- as.matrix(test_df %>% dplyr::select(-Y))
test-y <- test_df$Y
cv.fit <- glmnet(train_X, train_y, alpha = a, lambda = lambdas)
plot(cv.fit)
opt.1 <- cv.fit$lambda.min
opt.fit <- cv.fit$glmnet.fit
bets <- as.matrix(coef(opt.fit, s = cv.fit$lambda.min))
n_non0_betas <- sum(betas!=0)
pred_y <- predict(opt.fit, s = opt.1, newx = test_X)
mse <- mean((test_y - pred_y)^2)
return(list(alpha = a, mse = mse, opt.lambda = opt.1,
n_non0_betas = n_non0_betas))
}
allyhat <- function(xtrain, ytrain, xtest, lambdas, nvmax) {
n <- nrow(xtrain)
yhat <- matrix(nrow=nrow(xtest), ncol=length(lambdas))
search <-  regsubsets(xtrain, ytrain, nvmax, method = "back")
summ <- summary(search)
for(i in 1:length(lambdas)) {
penMSE <- n*log(summ$rss) + lambdas[i]*(1:nvmax)
best <- which.min(penMSE)
betahat <- coef(search, best)
xinmodel <- cbind(1, xtest)[,summ$which[best, ]]
yhat[, i] <- xinmodel%*%betahat
}
yhat
}
WWT.yes <- WWT.modelling %>% filter(condition_CCTV_app_availability == "yes")
WWT.no <- WWT.modelling %>% filter(condition_CCTV_app_availability == "no")
missing_plot(WWT.yes)
missing_plot(WWT.no)
set.seed(123)
sample.index <- sample(1:nrow(WWT.yes), size = 0.8 * nrow(WWT.yes))
WWT.yes.train <- WWT.yes[sample.index, ]
WWT.yes.test <- WWT.yes[-sample.index, ]
condition.tree1 <- rpart(condition_overall_score_label~., data = WWT.yes.train)
plotcp(condition.tree1)
predict1 <- predict(condition.tree1, WWT.no, type = "class")
confMatrix1 <- table(Actual = WWT.no$condition_overall_score_label, Predicted = predict1)
confMatrix1
sum(diag(confMatrix1)) / nrow(WWT.no)
plot(condition.tree1, margin = 0.2)
text(condition.tree1, pretty = 2)
summary(WWT.yes$condition_overall_score_label)
set.seed(749)
sample.index <- sample(1:nrow(WWT.yes), size = 0.8 * nrow(WWT.yes))
WWT.yes.train <- WWT.yes[sample.index, ]
WWT.yes.test <- WWT.yes[-sample.index, ]
condition.tree1 <- rpart(condition_overall_score_label~., data = WWT.yes.train)
plotcp(condition.tree1)
predict1 <- predict(condition.tree1, WWT.no, type = "class")
confMatrix1 <- table(Actual = WWT.no$condition_overall_score_label, Predicted = predict1)
confMatrix1
sum(diag(confMatrix1)) / nrow(WWT.no)
plot(condition.tree1, margin = 0.2)
text(condition.tree1, pretty = 2)
printcp(condition.tree1)
set.seed(123)
sample.index <- sample(1:nrow(WWT.yes), size = 0.8 * nrow(WWT.yes))
WWT.yes.train <- WWT.yes[sample.index, ]
WWT.yes.test <- WWT.yes[-sample.index, ]
condition.tree1 <- rpart(condition_overall_score_label~., data = WWT.yes.train, cp=  0.023810)
plotcp(condition.tree1)
predict1 <- predict(condition.tree1, WWT.no, type = "class")
confMatrix1 <- table(Actual = WWT.no$condition_overall_score_label, Predicted = predict1)
confMatrix1
sum(diag(confMatrix1)) / nrow(WWT.no)
plot(condition.tree1, margin = 0.2)
text(condition.tree1, pretty = 2)
printcp(condition.tree1)
rf_model <- ranger(condition_overall_score_label ~ ., data = WWT.yes.train, trees = 500, mtry = 2)
predict2 <- predict(rf_model, WWT.no, type = "response")
confMatrix1 <- table(Actual = WWT.no$condition_overall_score_label, Predicted = predict1)
confMatrix1
rf_model <- ranger(condition_overall_score_label ~ ., data = WWT.yes.train, trees = 500, mtry = 2)
predict2 <- predict(rf_model, WWT.no, type = "response")
confMatrix2 <- table(Actual = WWT.no$condition_overall_score_label, Predicted = predict1)
confMatrix2
sum(diag(confMatrix2)) / nrow(WWT.no)
rf_model <- ranger(condition_overall_score_label ~ ., data = WWT.yes.train, trees = 500, mtry = 2)
predict2 <- predict(rf_model, WWT.no, type = "response")
confMatrix2 <- table(Actual = WWT.no$condition_overall_score_label, Predicted = predict2)
rf_model <- ranger(condition_overall_score_label ~ ., data = WWT.yes.train, trees = 1000 , mtry = 4)
predict2 <- predict(rf_model, WWT.no, type = "response")
confMatrix2 <- table(Actual = WWT.no$condition_overall_score_label, Predicted = predict2)
WWT.no$condition_overall_score_label
summary(predict2)
summary(rf_model)
rf_model <- ranger(condition_overall_score_label ~ ., data = WWT.yes.train, trees = 1000 , mtry = 4)
WWT.modelling$condition_overall_score_label
summary(WWT.modelling$condition_overall_score_label)
summary(WWT.modelling$condition_overall_score_label)
summary(WWT.yes$condition_overall_score_label)
summary(WWT.no$condition_overall_score_label)
WWT.yes <- WWT.yes %>% select(-condition_CCTV_app_availability)
str(WWT.yes)
WWT.yes <- WWT.yes %>% select(-`condition_CCTV_app_availability`)
WWT.yes <- WWT.yes %>% select(-`condition_CCTV_app_availability`)
WWT.yes <- WWT.yes %>% select(-`condition_CCTV_app_availability`)
WWT.yes <- WWT.yes %>% select(-`condition_CCTV_app_availability`)
WWT.yes <- WWT.yes %>% select(-`condition_CCTV_app_availability`)
WWT.yes <- WWT.yes %>% select(-`condition_CCTV_app_availability`)
getwd()
setwd("C:/Users/SSabharwal/OneDrive - Watercare Services Limited/Pred_Modelling_Condition/WWT_prior")
library(ggplot2)
library(tidyverse)
library(readxl)
library(lubridate)
library(corrplot)
library(naniar)
WWT_prior <- read_xlsx("C:/Users/SSabharwal/OneDrive - Watercare Services Limited/Pred_Modelling_Condition/WWT_prior/WWT_prioritisation_final.xlsx")
# Getting rid of useless columns
WWT_prior <- WWT_prior %>% select(-GIS_ID)
WWT_prior <- WWT_prior %>% select(-GIS_ID)
WWT_prior <- WWT_prior %>% select(-OBJECTID)
WWT_prior <- WWT_prior %>% select(-WSL_OBJECTID)
WWT_prior <- WWT_prior %>% select(-EQUIP_ID)
WWT_prior <- WWT_prior %>% select(-COMPKEY)
WWT_prior <- WWT_prior %>% select(-FAC_CODE)
WWT_prior <- WWT_prior %>% select(-FAC_DESC)
WWT_prior <- WWT_prior %>% select(-PROCESS)
WWT_prior <- WWT_prior %>% select(-GRP)
WWT_prior <- WWT_prior %>% select(-POSITION)
WWT_prior <- WWT_prior %>% select(-STATUS)
WWT_prior <- WWT_prior %>% select(-LINING)
WWT_prior <- WWT_prior %>% select(-US_INV)
WWT_prior <- WWT_prior %>% select(-DS_INV)
WWT_prior <- WWT_prior %>% select(-ACCURACY)
WWT_prior <- WWT_prior %>% select(-TYPE)
WWT_prior <- WWT_prior %>% select(-SERVICE)
WWT_prior <- WWT_prior %>% select(-DATASOURCE)
WWT_prior <- WWT_prior %>% select(-SUBTYPE)
WWT_prior <- WWT_prior %>% select(-FLOWDIR)
WWT_prior <- WWT_prior %>% select(-FLOWDIRACC)
WWT_prior <- WWT_prior %>% select(-HACOMPKEY)
WWT_prior <- WWT_prior %>% select(-R_STAT)
WWT_prior <- WWT_prior %>% select(-R_MAT)
WWT_prior <- WWT_prior %>% select(-R_DIA)
WWT_prior <- WWT_prior %>% select(-R_INST)
WWT_prior <- WWT_prior %>% select(-AQ_TYPE)
WWT_prior <- WWT_prior %>% select(-USE_AREA)
WWT_prior <- WWT_prior %>% select(-HAUNITTYPE)
WWT_prior <- WWT_prior %>% select(-USE_AREAID)
WWT_prior <- WWT_prior %>% select(-R_OWN)
WWT_prior <- WWT_prior %>% select(-OWN)
WWT_prior <- read_xlsx("C:/Users/SSabharwal/OneDrive - Watercare Services Limited/Pred_Modelling_Condition/WWT_prior/WWT_prioritisation_final.xlsx")
WWT_prior <- WWT_prior %>% select(-GIS_ID)
library(ggplot2)
library(tidyverse)
library(readxl)
library(lubridate)
library(corrplot)
library(naniar)
WWT_prior <- read_xlsx("C:/Users/SSabharwal/OneDrive - Watercare Services Limited/Pred_Modelling_Condition/WWT_prior/WWT_prioritisation_final.xlsx")
# Getting rid of useless columns
WWT_prior <- WWT_prior %>% select(-GIS_ID)
library(ggplot2)
library(tidyverse)
library(readxl)
library(lubridate)
library(corrplot)
library(naniar)
WWT_prior <- read_xlsx("C:/Users/SSabharwal/OneDrive - Watercare Services Limited/Pred_Modelling_Condition/WWT_prior/WWT_prioritisation_final.xlsx")
# Getting rid of useless columns
WWT_prior <- WWT_prior %>% select(-GIS_ID)
WWT_prior <- WWT_prior %>% select(-OBJECTID)
WWT_prior <- WWT_prior %>% select(-WSL_OBJECTID)
WWT_prior <- WWT_prior %>% select(-EQUIP_ID)
WWT_prior <- WWT_prior %>% select(-COMPKEY)
WWT_prior <- WWT_prior %>% select(-FAC_CODE)
WWT_prior <- WWT_prior %>% select(-FAC_DESC)
WWT_prior <- WWT_prior %>% select(-PROCESS)
WWT_prior <- WWT_prior %>% select(-GRP)
WWT_prior <- WWT_prior %>% select(-POSITION)
WWT_prior <- WWT_prior %>% select(-STATUS)
WWT_prior <- WWT_prior %>% select(-LINING)
WWT_prior <- WWT_prior %>% select(-US_INV)
WWT_prior <- WWT_prior %>% select(-DS_INV)
WWT_prior <- WWT_prior %>% select(-ACCURACY)
WWT_prior <- WWT_prior %>% select(-TYPE)
WWT_prior <- WWT_prior %>% select(-SERVICE)
WWT_prior <- WWT_prior %>% select(-DATASOURCE)
WWT_prior <- WWT_prior %>% select(-SUBTYPE)
WWT_prior <- WWT_prior %>% select(-FLOWDIR)
WWT_prior <- WWT_prior %>% select(-FLOWDIRACC)
WWT_prior <- WWT_prior %>% select(-HACOMPKEY)
WWT_prior <- WWT_prior %>% select(-R_STAT)
WWT_prior <- WWT_prior %>% select(-R_MAT)
WWT_prior <- WWT_prior %>% select(-R_DIA)
WWT_prior <- WWT_prior %>% select(-R_INST)
WWT_prior <- WWT_prior %>% select(-AQ_TYPE)
WWT_prior <- WWT_prior %>% select(-USE_AREA)
WWT_prior <- WWT_prior %>% select(-HAUNITTYPE)
WWT_prior <- WWT_prior %>% select(-USE_AREAID)
WWT_prior <- WWT_prior %>% select(-R_OWN)
WWT_prior <- WWT_prior %>% select(-OWN)
WWT_prior <- WWT_prior %>% select(-PARLINENO)
WWT_prior <- WWT_prior %>% select(-F_IwiAOI)
WWT_prior <- WWT_prior %>% select(-`New action`)
# Need to fix data types for certain columns/Need to fix and normalise some entries
WWT_prior <- WWT_prior %>%
mutate(across(where(is.character), as.factor))
WWT_prior$condition_CCTV_score <- as.numeric(WWT_prior$condition_CCTV_score)
WWT_prior$condition_overall_score_label <- as.factor(WWT_prior$condition_overall_score_label)
levels(WWT_prior$condition_CCTV_source) <- c(levels(WWT_prior$condition_CCTV_source), "None")
WWT_prior$condition_CCTV_source[is.na(WWT_prior$condition_CCTV_source)] <- "None"
WWT_prior$condition_CCTV_date <- as.factor(WWT_prior$condition_CCTV_date)
levels(WWT_prior$condition_CCTV_date) <- c(levels(WWT_prior$condition_CCTV_date), "None")
WWT_prior$condition_CCTV_date[is.na(WWT_prior$condition_CCTV_date)] <- "None"
WWT_prior$condition_CCTV_score <- as.factor(WWT_prior$condition_CCTV_score)
levels(WWT_prior$condition_CCTV_score) <- c(levels(WWT_prior$condition_CCTV_score), "None")
WWT_prior$condition_CCTV_score[is.na(WWT_prior$condition_CCTV_score)] <- "None"
WWT_prior$INSTALLED <- format(WWT_prior$INSTALLED, "%Y")
WWT_prior$INSTALLED <- as.numeric(WWT_prior$INSTALLED)
# Creating modelling data set and analysis data set
WWT.analysis <- WWT_prior
WWT.analysis <- WWT.analysis %>% select(-SHAPE_Length)
WWT.modelling <- WWT_prior
WWT.modelling <- WWT.modelling %>% select(-condition_overall_score)
WWT.modelling <- WWT.modelling %>% select(-criticality_overall_score)
WWT.modelling <- WWT.modelling %>% select(-criticality_overall_score_label)
WWT.modelling <- WWT.modelling %>% select(-criticality_operational_score)
WWT.modelling <- WWT.modelling %>% select(-criticality_pipe_type_score)
WWT.modelling <- WWT.modelling %>% select(-criticality_people_impacts_score)
WWT.modelling <- WWT.modelling %>% select(-criticality_people_impacts_dataset_s_)
WWT.modelling <- WWT.modelling %>% select(-criticality_environmental_impacts_score)
WWT.modelling <- WWT.modelling %>% select(-criticality_environmental_impacts_dataset_s_)
WWT.modelling <- WWT.modelling %>% select(-criticality_infiltration_score)
WWT.modelling <- WWT.modelling %>% select(-criticality_impact_of_failure_score)
WWT.modelling <- WWT.modelling %>% select(-criticality_flow_ratio)
WWT.modelling <- WWT.modelling %>% select(-criticality_confidence_scenario)
WWT.modelling <- WWT.modelling %>% select(-condition_confidence_scenario)
WWT.modelling <- WWT.modelling %>% select(-`Risk-score`)
knitr::opts_chunk$set(message = FALSE)
knitr::opts_chunk$set(message = FALSE)
library(ggplot2)
library(tidyverse)
library(readxl)
library(lubridate)
library(corrplot)
library(naniar)
library(keras)
library(glmnet)
library(xgboost)
library(finalfit)
library(rpart)
library(MASS)
library(ranger)
myfit <- function(train_df, test_df, a = 0){
train_X <- as.matrix(train_df %>% dplyr::select(-Y))
train_y <- train_df$Y
test_X <- as.matrix(test_df %>% dplyr::select(-Y))
test-y <- test_df$Y
cv.fit <- glmnet(train_X, train_y, alpha = a, lambda = lambdas)
plot(cv.fit)
opt.1 <- cv.fit$lambda.min
opt.fit <- cv.fit$glmnet.fit
bets <- as.matrix(coef(opt.fit, s = cv.fit$lambda.min))
n_non0_betas <- sum(betas!=0)
pred_y <- predict(opt.fit, s = opt.1, newx = test_X)
mse <- mean((test_y - pred_y)^2)
return(list(alpha = a, mse = mse, opt.lambda = opt.1,
n_non0_betas = n_non0_betas))
}
allyhat <- function(xtrain, ytrain, xtest, lambdas, nvmax) {
n <- nrow(xtrain)
yhat <- matrix(nrow=nrow(xtest), ncol=length(lambdas))
search <-  regsubsets(xtrain, ytrain, nvmax, method = "back")
summ <- summary(search)
for(i in 1:length(lambdas)) {
penMSE <- n*log(summ$rss) + lambdas[i]*(1:nvmax)
best <- which.min(penMSE)
betahat <- coef(search, best)
xinmodel <- cbind(1, xtest)[,summ$which[best, ]]
yhat[, i] <- xinmodel%*%betahat
}
yhat
}
WWT.yes <- WWT.modelling %>% filter(condition_CCTV_app_availability == "yes")
WWT.no <- WWT.modelling %>% filter(condition_CCTV_app_availability == "no")
missing_plot(WWT.yes)
missing_plot(WWT.no)
WWT.yes <- WWT.yes %>% select(-condition_CCTV_app_availability)
WWT.yes <- WWT.yes %>% select(-condition_CCTV_app_availability)
WWT.yes <- WWT.yes %>% select(-condition_CCTV_app_availability)
WWT.yes <- WWT.yes %>% select(-condition_CCTV_app_availability)
WWT.yes <- WWT.yes %>% select(-condition_CCTV_app_availability)
WWT.yes <- WWT.yes %>% select(-condition_CCTV_app_availability)
WWT.yes <- WWT.yes %>% select(-condition_CCTV_app_availability)
WWT.yes <- WWT.yes %>% select(-condition_CCTV_app_availability)
WWT.yes <- WWT.yes %>% select(-condition_CCTV_app_availability)
View(WWT.yes)
View(WWT.yes)
WWT.yes <- df[, -9]
WWT.yes <- WWT.yes[, -9]
WWT.no <- WWT.no[, -9]
rf_model <- ranger(condition_overall_score_label ~ ., data = WWT.yes.train, trees = 1000 , mtry = 4)
set.seed(123)
rows_to_move <- which(WWT.no$condition_overall_score_label == "5")
num_to_select <- min(5, length(rows_to_move))
selected_rows <- sample(rows_to_move, num_to_select)
WWT.yes <- WWT.yes %>% rbind(WWT.no[selected_rows, ])
WWT.no <- WWT.no[-selected_rows]
WWT.no <- WWT.no[-selected_rows,]
summary(WWT.yes$condition_overall_score_label)
summary(WWT.no$condition_overall_score_label)
set.seed(123)
sample.index <- sample(1:nrow(WWT.yes), size = 0.8 * nrow(WWT.yes))
WWT.yes.train <- WWT.yes[sample.index, ]
WWT.yes.test <- WWT.yes[-sample.index, ]
condition.tree1 <- rpart(condition_overall_score_label~., data = WWT.yes.train, cp=  0.023810)
plotcp(condition.tree1)
predict1 <- predict(condition.tree1, WWT.no, type = "class")
confMatrix1 <- table(Actual = WWT.no$condition_overall_score_label, Predicted = predict1)
confMatrix1
summary(WWT.yes.train$condition_overall_score_label)
set.seed(123)
rows_to_move <- which(WWT.no$condition_overall_score_label == "5")
num_to_select <- min(10, length(rows_to_move))
selected_rows <- sample(rows_to_move, num_to_select)
WWT.yes <- WWT.yes %>% rbind(WWT.no[selected_rows, ])
WWT.no <- WWT.no[-selected_rows,]
summary(WWT.yes$condition_overall_score_label)
summary(WWT.no$condition_overall_score_label)
library(ggplot2)
library(tidyverse)
library(readxl)
library(lubridate)
library(corrplot)
library(naniar)
WWT_prior <- read_xlsx("C:/Users/SSabharwal/OneDrive - Watercare Services Limited/Pred_Modelling_Condition/WWT_prior/WWT_prioritisation_final.xlsx")
# Getting rid of useless columns
WWT_prior <- WWT_prior %>% select(-GIS_ID)
library(ggplot2)
library(tidyverse)
library(readxl)
library(lubridate)
library(corrplot)
library(naniar)
WWT_prior <- read_xlsx("C:/Users/SSabharwal/OneDrive - Watercare Services Limited/Pred_Modelling_Condition/WWT_prior/WWT_prioritisation_final.xlsx")
# Getting rid of useless columns
WWT_prior <- WWT_prior %>% select(-GIS_ID)
